# 分布式注册中心

在单体式服务中，通常是由多个客户端去调用一个服务，只要在客户端中配置唯一服务节点地址即可，当升级到分布式后，服务节点变多，像阿里一线大厂服务节点更是上万之多，这么多节点不可能手动配置在客户端，这里就需要一个中间服务，专门用于帮助客户端发现服务节点，即许多技术书籍经常提到的**服务发现**。

![](https://img-blog.csdnimg.cn/20200709182717555.png)

一个完整的注册中心涵盖以下功能特性：
* 服务注册：提供者上线时将自提供的服务提交给注册中心。
* 服务注销：通知注册中心提供者下线。
* 服务订阅：动态实时接收服务变更消息。
* 可靠：注册服务本身是集群的，数据冗余存储。避免单点故障，及数据丢失。
* 容错：当服务提供者出现宕机，断电等极情况时，注册中心能够动态感知并通知客户端服务提供者的状态。

## Dubbo 对zookeeper的使用

阿里著名的开源项目Dubbo 是一个基于JAVA的RCP框架，其中必不可少的注册中心可基于多种第三方组件实现，但其官方推荐的还是Zookeeper做为注册中心服务。

![](https://img-blog.csdnimg.cn/20200709182937444.png)

Dubbo Zookeeper注册中心存储结构：
![](https://img-blog.csdnimg.cn/20200709183007245.png)

**节点说明：**
| **类别**   | **属性**   | **说明**   |
|:----|:----|:----|
| **Root**   | 持久节点   | 根节点名称，默认是 "dubbo"   |
| **Service**   | 持久节点   | 服务名称，完整的服务类名   |
| **type**   | 持久节点   | 可选值：providers(提供者)、consumers（消费者）、configurators(动态配置)、routers   |
| **URL**   | 临时节点   | url名称 包含服务提供者的 IP 端口 及配置等信息。   |

**流程说明：**
1. 服务提供者启动时: 向/dubbo/com.foo.BarService/providers目录下写入自己的 URL 地址
2. 服务消费者启动时: 订阅/dubbo/com.foo.BarService/providers目录下的提供者 URL 地址。并向/dubbo/com.foo.BarService/consumers目录下写入自己的 URL 地址
3. 监控中心启动时: 订阅/dubbo/com.foo.BarService目录下的所有提供者和消费者 URL 地址。